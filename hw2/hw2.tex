\documentclass[11pt]{article}
\usepackage{fullpage}
\usepackage{amsmath,amssymb,amsfonts,float}
\renewcommand\vec[1]{\mathbf{#1}}
\usepackage{listings}
\usepackage[table]{xcolor}
\usepackage{framed,comment}

\newcommand\red[1]{\textcolor{red}{#1}}
\specialcomment{solution}{\bigskip\begin{leftbar}\par\noindent\textbf{Solution.} }{\end{leftbar} }
\begin{document}

\begin{tabular}{l}
\textbf{CSCI 5654-Fall16}: Assignment \#2 \\

\textbf{Robert Werthman} \phantom{Supercalifragilisticexpialidocius Smith}\\
\hline
\\[10pt]
\end{tabular}

\noindent
\textbf{P1.}


\noindent (A)
\begin{center}
\begin{tabular}{|c|c|}
\hline
Entering variables & Leaving variables\\
\hline
$x_2$ & $w_1\ \text{or}\ w_5$ \\
\hline
$x_5$ & $w_5$\\
\hline
$x_6$ & $w_2\ \text{or}\ x_3$\\
\hline
$w_3$ & $w_2\ \text{or}\ x_3$\\
\hline
\end{tabular}
\end{center}

\medskip

\noindent\textbf{(B)}\\ 
To find the corresponding solutions, we need to solve for $x_2$ in the $w_5$ row of the dictionary:
$$
x_2 = 2 - \frac{x_1}{2} - 2x_5 + \frac{w_4}{2} - \frac{w_5}{2}
$$
This equation is then plugged into all the places $x_2$ is a nonbasic variable.
\begin{center}
\begin{tabular}{|c|c|}
\hline
Basic variables & Solutions\\
\hline
$w_1$ & 0\\ \hline
$w_2$ & 2\\ \hline
$x_3$ & 4\\ \hline
$x_4$ & 1\\ \hline
$x_2$ & 2\\ \hline
$z$ & 15\\ \hline
\end{tabular}
\hspace{1cm}
\begin{tabular}{|c|c|}
\hline
Nonbasic variables\\
\hline
$x_1$\\ \hline
$w_5$\\ \hline
$x_5$\\ \hline
$x_6$\\ \hline
$w_3$\\ \hline
$w_4$\\ \hline
\end{tabular}
\end{center}
Yes, this dictionary is degenerate.  The solution $b$ of the basic variable $w_1$ is 0.
\medskip

\noindent\textbf{(C)}\\
The next dictionary looks like:
\[ \begin{array}{r| c c c c c c c}
w_1 & 0 &- 7x_1 &- 7x_5 &+ w_4 &- 2w_5 &- 2x_6 &+ 2w_3\\
w_2 & 2 & -x_1 & -x_5 & & & -x_6 & -w_3 \\
x_3 & 4 & -\frac{x_1}{2} & -\frac{w_5}{2} & -\frac{3w_4}{2} & -\frac{w_5}{2} & -x_6 & -w_3 \\
x_4 & 1 & -\frac{x_1}{2} & +x_5 & +\frac{w_4}{2} & +\frac{w_5}{2} & -x_6 & +2w_3 \\
x_2 & 2 & -\frac{x_1}{2} & -2x_5 & +\frac{w_4}{2} & -\frac{w_5}{2} && \\
\hline
z & 15 & -2x_1 & -3x_5 & -w_4 & -w_5 & +x_6 & +3w_3 \\
\end{array}\]
We can choose betwen $x_6$ and $w_3$ to be the entering variable.  We should choose $w_3$ to be the entering variable, because it increases the value of the objective function $z$ the most.  Since the leaving variable is automatically chosen based on the which basic variable constrains the entering variable the most, the value of the objective function does not depend on the choice of the leaving variable.

\medskip


\noindent\textbf{P2. (15 points)}  Consider the following feasible dictionary:

\[\begin{array}{r|c c c c c c c c}
x_{B,1} & b_1 & + a_{11} x_{N,1} & + \cdots & + \red{a_{1j}} x_{N,j} & \cdots & + a_{1n} x_{N,n}\\
\vdots & \vdots &  & \ddots & \vdots & \ddots  \\
x_{B,i} & b_i & +a_{i1} x_{N,1} & + \cdots & +\red{ a_{ij}} x_{N,j} & \cdots
                                                                & + a_{in} x_{N,n} \\
\vdots & & \ddots & \\ 
x_{B,m} & b_m & + a_{m1} x_{N,1} & + \cdots & +\red{ a_{mj} } x_{N,j} &
                                                                 \cdots  & + a_{mn} x_{N,n} \\
\hline
z & c_0 & + c_1 x_{N,1} & + \cdots & + \red{c_j} x_{N,j} & \cdots & + c_n x_{N,n}\\
\end{array}\]

\noindent \textbf{(A)} Suppose $x_{N,j}$ is chosen to enter and
$x_{B,i}$ is the corresponding leaving variable, then show that the
value of $x_{B,k}$ in the next dictionary after pivoting is given by
\[ b_k + a_{kj} \left(\frac{b_i}{ - a_{ij}}\right)  \,.\]

Also write down for each of the constants $b_k, a_{kj}, b_i, a_{ij}$
whether it is known that constant will be $> 0$, $< 0$, $\geq 0$,
$\leq 0$ or nothing may be said about its sign.
\\
$x_{N,j}$ is the entering variable and $x_{B,i}$ is the leaving variable.  This means, first, we need to solve the current equation given for $x_{B,i}$ for $x_{N,j}$.  We start with the equation:
$$
x_{B,i} = b_i + a_{i1}x_{N,1} + \cdots + a_{ij}x_{N,j} + \cdots + a_{in}x_{N,n}
$$
Solving for $x_{N,j}$ we get the equation:
$$
x_{N,j} = \frac{b_i}{-a_{ij}} + \frac{a_{i1}x_{N,1}}{-a_{ij}} + \cdots + \frac{a_{in}x_{N,n}}{-a_{ij}} + \frac{x_{B,i}}{-a_{ij}}
$$
The next step is to take that equation and plug it into any instances of $x_{N,j}$ on the nonbasic side of the dictionary.  If we use it in the equation for $x_{B,k}$ then we get the equation:
$$
x_{B,k} = b_k + a_{k1}x_{N,1} + \cdots + a_{kj}(\frac{b_i}{-a_{ij}} + \frac{a_{i1}x_{N,1}}{-a_{ij}} + \cdots + \frac{a_{in}x_{N,n}}{-a_{ij}} + \frac{x_{B,i}}{-a_{ij}}) + \cdots + a_{kn}x{N,n}
$$
Since we are trying to find the value of $x_{B,k}$, we set all of the nonbasic variables to 0 in the equation for $x_{B,k}$ yielding:
$$
x_{B,k} = b_k + a_{kj}(\frac{b_i}{-a_{ij}})
$$
\begin{tabular}{|c|c|c|}
\hline
Constant & Sign & Reason\\ \hline
$b_k$ & $\ge 0$ & Dictionary is feasible\\ \hline
$a_{kj}$ & Nothing may be said about its sign & Coefficient could be any value\\  \hline
$b_i$ & $\ge 0$ & Dictionary is feasible\\ \hline
$a_{ij}$ & $< 0$ & Entering variable must be constrained\\ \hline
\end{tabular}

\medskip

\noindent \textbf{(B)} Show that if the leaving variable analysis is
correct then  the value of each basic variable $x_{B,k}$ in the
subsequent 
dictionary is  $\geq 0$. In other words: 
\[  b_k + a_{kj} \left(\frac{b_i}{ - a_{ij}}\right)  \geq 0 \,.\]

In other words, we conclude that starting from a feasible dictionary
and pivoting yields another feasible dictionary.

(\textbf{Hint:} Split two cases on the sign of $a_{kj}$. For one case
it will be trivially true. For the other, you have to appeal to the
leaving variable analysis as to why $x_{B,i}$ was the leaving variable and
not $x_{B,k}$).

\medskip


\noindent\textbf{(C)} Using the analysis above, prove that if $x_{B,k}$
and $x_{B,i}$ are both possible leaving variables ($i \not= k$) for $x_{N,j}$ entering,
then  the subsequent dictionary will be degenerate.  (\textbf{Hint:}
Assume that $x_{B,i}$ is chosen to leave. Show that even though $x_{B,k}$ did not leave the basis, its value in
the  next dictionary will be $0$).

\bigskip

\noindent\textbf{P3 (10 points)}  Provide examples of dictionaries
that satisfy the properties stated below. Try to construct
examples that are as small as possible. If no such
dictionaries can exist, briefly reason why.


\noindent\textbf{(A)} A degenerate dictionary that is also unbounded. 
Recall that an unbounded dictionary does not have a leaving variable for some
choice of an entering variable.

\medskip

\noindent\textbf{(B)} A degenerate dictionary $D$ which upon pivoting
yields another degenerate dictionary $D'$, but the objective value strictly
increases.

\medskip

\noindent\textbf{(C)} A non-degenerate dictionary $D$ which upon pivoting
yields another dictionary $D'$ but the value of the objective function
stays the same.

\medskip

\noindent\textbf{(D)} A dictionary that is feasible but upon pivoting
yields an infeasible dictionary.


\medskip

\noindent\textbf{(E)} A dictionary that does not have leaving variable
(is unbounded) for one choice of entering variable but has a leaving
variable for a different choice of an entering variable.

\bigskip

\noindent\textbf{P4 (15 points)}  Consider the polyhedron below:
\[ \begin{array}{ccccc}
 -x & + 2 y & + 2z & \leq & 2 \\
2 x & - y & + 2z & \leq & 2 \\
x & & & \geq & 0\\
& y& & \geq & 0 \\
& & z & \geq & 0 \\
\end{array}\]

\noindent\textbf{(A)} Compute all the vertices and for each vertex
write down if it is degenerate or non-degenerate.

\noindent\textbf{(B)} Consider the optimization problem:
\[ \begin{array}{rcccccc}
\max & 2x & + 3y & - 2z \\
\mathsf{s.t} &  -x & + 2 y & + 2z & \leq & 2 & \# Slack\ w_1\\
& 2 x & - y & + 2z & \leq & 2 & \# Slack\ w_2\\
& x & & & \geq & 0\\
& & y& & \geq & 0 \\
& & & z & \geq & 0 \\
\end{array}\]

Write down all the dictionaries corresponding to the degenerate
vertices. Use slack variables $w_1, w_2$ as indicated.

\noindent\textbf{(C)} Draw a graph whose nodes are the vertices
described in (A) with edges between adjacent vertices. 

\medskip

\noindent\textbf{(D, extra credit)} Given a polyhedron $P$, and for
each vertex of the polyhedron,  can you  write down an
objective function that is uniquely maximized only at that vertex and
no other vertex of $P$? 


\medskip

\noindent\textbf{(E, extra credit)} For any polyhedron $P$, the
polyhedral graph (also called its skeleton) is one where the nodes
form the vertices of the polyhedron, and the edges connect adjacent
vertices. Prove that this graph is strongly connected for any
$P$. I.e, given any two vertices $\mathbf{v}_1$ and $\mathbf{v_2}$
there is a path between them in this graph.

\medskip

\noindent\textbf{(F, extra credit)}  Prove that the graph in part (E)
for a d-dimensional polyhedron $P$ has the property that if any subset
of $d-1$ or fewer vertices in the graph are removed, it will still
remain strongly connected (This is called Balinski's theorem).

To illustrate this, draw the skeleton of a cube and remove any two
vertices from this skeleton. You will notice that there is a path in
this graph between any pair of remaining vertices.



\end{document}
